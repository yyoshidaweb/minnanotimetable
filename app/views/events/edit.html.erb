<div class="pb-[calc(5.25rem+env(safe-area-inset-bottom))]">
  <div class="max-w-md mx-auto my-4 p-6 bg-white shadow-md rounded-lg"
       data-controller="tag-suggestion"
       data-tag-suggestion-url-value="<%= search_event_name_tags_path %>">
    <%= form_with model: @event, url: event_path(@event.event_key), method: :patch, class: "space-y-6" do |f| %>
      <%# エラーメッセージ %>
      <%= render "devise/shared/error_messages", resource: @event %>
      <%# ─ イベント名（タグ入力＋候補表示） ─ %>
      <div>
        <%= f.label :event_name_tag, "イベント名", class: "block text-sm font-semibold text-gray-800 mb-1" %>
        <%# fields_for を使って nested attributes の形で name を送る (event[event_name_tag_attributes][name]) %>
        <%= f.fields_for :event_name_tag do |ff| %>
          <%= ff.text_field :name,
            value: @event.event_name_tag&.name,
            class: "w-full border border-gray-300 rounded-md px-3 py-2 text-gray-800 
                    focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-gray-800",
            data: {
              tag_suggestion_target: "input",
              action: "input->tag-suggestion#search"
            } %>
          <%# タグ候補（ポップアップ表示領域） %>
          <div class="relative" data-tag-suggestion-target="results"></div>
        <% end %>
      </div>
      <%# 説明欄 %>
      <div>
        <%= f.label :description, "説明", class: "block text-sm font-semibold text-gray-800 mb-1" %>
        <%= f.text_area :description,
          class: "w-full border border-gray-300 rounded-md px-3 py-2 text-gray-800
                  focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-gray-800 min-h-24 resize-none",
          rows: 3,
          data: {
            controller: "autosize",
            action: "input->autosize#resize",
            autosize_target: "textarea"
          } %>
      </div>
      <%# 作成ボタン %>
      <div>
        <%= f.submit "更新",
          class: "w-full py-2 rounded-md bg-gray-800 text-white hover:bg-gray-900 transition cursor-pointer" %>
      </div>
    <% end %>
    <%= button_to "イベントを削除する",
                event_path(@event.event_key),
                method: :delete,
                data: { turbo_confirm: "⚠️ 削除しますか？ 一度削除すると元に戻せません" },
                class: "w-full mt-12 py-2 rounded-md bg-gray-800 text-red-500 hover:bg-red-700 hover:text-red-200 transition cursor-pointer" %>
    <!-- 作成日時 -->
    <div class="text-xs text-gray-500 mt-4">
      作成日: <%= l(@event.created_at.to_date, format: :default) %>
    </div>
  </div>
</div>
<%# 下部タブメニュー %>
<%= render "layouts/bottom_tab" %>