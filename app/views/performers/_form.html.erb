<div class="max-w-md mx-auto mt-10 p-6 bg-white shadow-md rounded-lg"
     data-controller="tag-suggestion"
     data-tag-suggestion-url-value="<%= search_performer_name_tags_path %>">
  <%= form_with model: @performer,
                data: { turbo: turbo_frame_request? },
                url: event_performers_path(@event.event_key),
                class: "space-y-6" do |f| %>
    <%# エラーメッセージ %>
    <%= render "devise/shared/error_messages", resource: @performer %>
    <%# ─ 出演者名（タグ入力＋候補表示） ─ %>
    <div>
      <%= f.label :performer_name_tag, "出演者名", class: "block text-sm font-semibold text-gray-800 mb-1" %>
      <%# fields_for を使って nested attributes の形で name を送る (performer[performer_name_tag_attributes][name]) %>
      <%= f.fields_for :performer_name_tag do |ff| %>
        <%= ff.text_field :name,
          value: @performer.performer_name_tag&.name,
          class: "w-full border border-gray-300 rounded-md px-3 py-2 text-gray-800 
                  focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-gray-800",
          data: {
            tag_suggestion_target: "input",
            action: "input->tag-suggestion#search"
          } %>
        <%# タグ候補（ポップアップ表示領域） %>
        <div class="relative" data-tag-suggestion-target="results"></div>
      <% end %>
    </div>
    <%# 説明欄 %>
    <div>
      <%= f.label :description, "説明", class: "block text-sm font-semibold text-gray-800 mb-1" %>
      <%= f.text_area :description,
        class: "w-full border border-gray-300 rounded-md px-3 py-2 text-gray-800
                focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-gray-800 min-h-24 resize-none",
        rows: 3,
        data: {
          controller: "autosize",
          action: "input->autosize#resize",
          autosize_target: "textarea"
        } %>
    </div>
    <%# Official website %>
    <div>
      <%= f.label :website_url, "Official website", class: "block text-sm font-semibold text-gray-800 mb-1" %>
      <%= f.text_field :website_url,
        class: "w-full border border-gray-300 rounded-md px-3 py-2 text-gray-800 focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-gray-800" %>
    </div>
    <%# 作成ボタン %>
    <div>
      <%= f.submit "作成",
        class: "w-full py-2 rounded-md bg-gray-600 text-white hover:bg-gray-700 transition cursor-pointer" %>
    </div>
  <% end %>
</div>
