<div class="flex flex-col items-center my-4 pb-[calc(5.25rem+env(safe-area-inset-bottom))]">
  <%= form_with url: update_sort_event_stages_path(@event.event_key),
                method: :patch,
                class: "w-full max-w-md space-y-4",
                data: { turbo: false } do %>
    <div class="w-full flex justify-start">
      <small class="text-xs text-gray-500">下部の「保存して並び替えを終了」を押すと、並び順が保存されます。</small>
    </div>
    <ul data-controller="sortable" id="stage-list" class="flex flex-col space-y-2">
      <% @stages.each do |stage| %>
        <li data-id="<%= stage.id %>"
            class="stage-card block bg-white shadow-sm rounded-lg p-4 border">
          <%= stage.display_name %>
          <span class="stage-handle material-symbols-outlined float-right text-gray-400">drag_handle</span>
          <%= hidden_field_tag "stage_ids[]", stage.id %>
        </li>
      <% end %>
    </ul>
    <%= submit_tag "保存して並び替えを終了",
                   class: "w-full py-2 rounded-md bg-gray-800 text-white hover:bg-gray-900 transition cursor-pointer" %>
  <% end %>
  <div class="w-full flex justify-center mt-1">
    <small class="text-xs text-gray-500">※並び順はタイムテーブルタブにも反映されます。</small>
  </div>
</div>
<%# 下部タブメニュー %>
<%= render "layouts/bottom_tab" %>